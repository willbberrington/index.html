<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Global Labour Screen Tracker</title>
<style>
body {
font-family: Arial, sans-serif;
max-width: 1200px;
margin: 0 auto;
padding: 20px;
background-color: #f5f5f5;
}
h1 {
text-align: center;
color: #333;
}
.videos-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
gap: 20px;
margin-top: 30px;
}
.video-card {
background: white;
border-radius: 8px;
overflow: hidden;
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.video-card iframe {
width: 100%;
height: 200px;
border: none;
}
.video-info {
padding: 15px;
}
.video-title {
font-size: 14px;
font-weight: bold;
margin: 0;
color: #333;
}
.loading {
text-align: center;
padding: 50px;
font-size: 18px;
color: #666;
}
.error {
background: #ffebee;
color: #c62828;
padding: 15px;
border-radius: 8px;
margin: 20px 0;
text-align: center;
}
.update-info {
background: #e3f2fd;
padding: 10px 15px;
border-radius: 8px;
margin: 20px 0;
text-align: center;
font-size: 14px;
color: #1565c0;
border-left: 4px solid #2196f3;
}
</style>
</head>
<body>
<h1>Global Labour Screen Tracker</h1>

<div class="update-info">
Videos update every Monday
</div>

<div id="loading" class="loading">Loading videos...</div>
<div id="error" class="error" style="display:none;"></div>
<div id="videos" class="videos-grid"></div>

<script>
// 
const API_KEY = 'AIzaSyBCQeWO5lhHka-2hvUeNyG2Kojqnum8eRc';

// CACHED VIDEO IDs - These are updated automatically every Monday
// Last updated: Week 5
const CACHED_VIDEOS = [];

// Search queries in different languages for "day in the life" worker videos
const searchQueries = [
'day in the life worker',
'a day in my life job',
'día en la vida trabajo', // Spanish (Spain)
'un día en mi vida trabajo', // Spanish variant
'día de trabajo en mi vida', // Latin American Spanish
'mi trabajo diario', // Spanish - daily work
'journée dans la vie travail', // French (France)
'une journée de travail', // French variant
'journée de travail en Afrique', // African French
'mon travail quotidien', // French - daily work
'Tag im Leben Arbeit', // German
'仕事の一日', // Japanese
'工作中的一天', // Chinese Simplified
'工作中的一天', // Chinese Traditional
'我的工作日常', // Chinese - my work routine
'职业日常', // Chinese - career daily life
'dia na vida trabalho', // Portuguese (Brazil)
'rotina de trabalho', // Portuguese - work routine
'день из жизни работа', // Russian
'мой рабочий день', // Russian - my work day
'giorno nella vita lavoro', // Italian
'직장인 하루', // Korean
'일상 브이로그 직장', // Korean - daily vlog work
'يوم في الحياة عمل', // Arabic
'dag in het leven werk', // Dutch
'dzień w życiu praca', // Polish
'how I dey work', // Nigerian Pidgin
'my work for Nigeria', // Nigerian Pidgin variant
'วันทำงานของฉัน', // Thai
'एक दिन मेरी नौकरी', // Hindi
'mijn dagelijks werk', // Dutch variant
'τη δουλειά μου', // Greek
'işimde bir gün', // Turkish
'pekerjaan sehari-hari', // Indonesian
'việc làm hàng ngày' // Vietnamese
];

function getWeekNumber(date) {
    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
    const dayNum = d.getUTCDay() || 7;
    d.setUTCDate(d.getUTCDate() + 4 - dayNum);
    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
    return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
}

function seededRandom(seed) {
    const x = Math.sin(seed) * 10000;
    return x - Math.floor(x);
}

async function searchYouTube(query, maxResults = 4) {
    const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(query)}&type=video&maxResults=${maxResults}&key=${API_KEY}`;
    try {
        const response = await fetch(url);
        if (!response.ok) throw new Error(`API Error: ${response.status}`);
        const data = await response.json();
        return data.items || [];
    } catch (error) {
        console.error('Search error:', error);
        return [];
    }
}

async function fetchNewVideos() {
    const weekNumber = getWeekNumber(new Date());
    const seed = weekNumber;
    
    // Pick 3 random languages based on the week
    const selectedQueries = [];
    for (let i = 0; i < 3; i++) {
        const index = Math.floor(seededRandom(seed + i) * searchQueries.length);
        selectedQueries.push(searchQueries[index]);
    }

    const allVideos = [];
    for (const query of selectedQueries) {
        const videos = await searchYouTube(query, 4);
        allVideos.push(...videos);
    }

    return allVideos.map(v => ({
        videoId: v.id.videoId,
        title: v.snippet.title
    }));
}

function displayVideos(videos) {
    document.getElementById('loading').style.display = 'none';
    const container = document.getElementById('videos');
    container.innerHTML = ''; 
    videos.forEach(video => {
        const videoCard = document.createElement('div');
        videoCard.className = 'video-card';
        videoCard.innerHTML = `
            <iframe src="https://www.youtube.com/embed/${video.videoId}" allowfullscreen></iframe>
            <div class="video-info"><p class="video-title">${video.title}</p></div>`;
        container.appendChild(videoCard);
    });
}

async function loadVideos() {
    try {
        // This will now fetch fresh videos automatically every time the week changes
        const videos = await fetchNewVideos();
        if (videos.length > 0) {
            displayVideos(videos);
        } else {
            throw new Error("No videos found. Check API key.");
        }
    } catch (error) {
        document.getElementById('loading').style.display = 'none';
        document.getElementById('error').style.display = 'block';
        document.getElementById('error').textContent = 'Error: ' + error.message;
    }
}

loadVideos();
</script>
</body>
</html>
